## ë°œí‘œìë£Œ


[í´ë¦°ì½”ë“œ ë¦¬ì•¡íŠ¸(React)](https://www.udemy.com/course/clean-code-react/learn/lecture/40031490?start=136#reviews)
ê°•ì˜ë¥¼ ë³´ê³  ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.

## 1. ì˜¬ë°”ë¥¸ ì´ˆê¸°ê°’ ì„¤ì •

> **ì´ˆê¸°ê°’**
> - ê°€ì¥ ë¨¼ì € ë Œë”ë§ë  ë•Œ ìˆœê°„ì ìœ¼ë¡œ ë³´ì—¬ì§ˆ ìˆ˜ ìˆëŠ” ê°’ì´ê¸°ë„ í•˜ë‹¤.
> - ë‹¹ì—°íˆ ì´ˆê¸°ì— ë Œë”ë§ ë˜ëŠ” ê°’  

- listì˜ ê°’ì„ mapìœ¼ë¡œ ëŒë• ì´ˆê¸° ê°’(ë¹ˆë°°ì—´)ì„ ì˜ ì§€ì •í•´ì¤˜ì•¼ ì“¸ë°ì—†ì´ ë Œë”ë§ í•˜ì§€ ì•ŠëŠ”ë‹¤.
- useStateê°€ ë¹„ì–´ìˆì„ ê²½ìš°ì—ëŠ” undefinedë¥¼ ê°€ì§€ê¸° ë•Œë¬¸ì— ì´ˆê¸°ê°’ì„ ì •í•´ì£¼ëŠ” ê²ƒì´ ì¢‹ë‹¤.

```jsx
// âŒ
const [list, setList] = useState();

list.map((item) => (
  <Item item={item} />
))
```
```jsx
// â­•ï¸
const [list, setList] = useState([]);

list.map((item) => (
  <Item item={item} />
))
```

- ì§€í‚¤ì§€ ì•Šì„ ê²½ìš°? â‡’ ë Œë”ë§ ì´ìŠˆ, ë¬´í•œ ë£¨í”„, íƒ€ì… ë¶ˆì¼ì¹˜ë¡œ ì˜ë„ì¹˜ ì•ŠëŠ” ë™ì‘ => ëŸ°íƒ€ì„ ì—ëŸ¬
- ì´ˆê¸°ê°’ì„ ë„£ì§€ ì•Šìœ¼ë©´? â‡’ undefined
- ìƒíƒœë¥¼ CRUD â‡’ ìƒíƒœë¥¼ ì§€ìš¸ ë•Œë„ ì´ˆê¸°ê°’ì„ ì˜ ê¸°ì–µí•´ë†”ì•¼ ì›ìƒíƒœë¡œ ëŒì•„ê°„ë‹¤.
- null ì²˜ë¦¬ë¥¼ í•  ë•Œ â‡’  ë¶ˆí•„ìš”í•œ ë°©ì–´ì½”ë“œë„ ì¤„ì—¬ì¤€ë‹¤.

## 2. ì—…ë°ì´íŠ¸ë˜ì§€ ì•ŠëŠ” ê°’

- ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì— ì§ì ‘ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ì§€ ì•ŠëŠ” ë³€ìˆ˜ë¥¼ ê°€ì§€ê³  ìˆìœ¼ë©´, ë§¤ë²ˆ ë Œë”ë§ ë  ë•Œë§ˆë‹¤ ë³€í•˜ì§€ ì•ŠëŠ” ê°’ì¸ë° ë¶ˆí•„ìš”í•˜ê²Œ ì°¸ì¡°í•˜ê²Œ ëœë‹¤.
- ë¦¬ì•¡íŠ¸ ìƒíƒœë¡œ ë°”ê¾¼ë‹¤ê±°ë‚˜ ì•„ì˜ˆ ì™¸ë¶€ë¡œ ë‚´ë³´ë‚´ë„ë¡ ìˆ˜ì •í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤

```jsx
// âŒ
// ìƒìˆ˜ë¥¼ ë‹¤ë£¨ê±°ë‚˜ ì¼ë°˜ì ì¸ ë°©ì¹˜
// ì—…ë°ì´íŠ¸ê°€ ë˜ì§€ ì•ŠëŠ” ì¼ë°˜ì ì¸ ê°ì²´
function component() {
	const INFO = {
	  name: 'My Component',
	  value: 'Clean Code React',
	};
  return (
    <div>
      <showCount info={INFO}  />
    </div>
  );
}
```
```jsx
// â­•ï¸
const INFO = {
  name: 'My Component',
  value: 'Clean Code React',
};
function component() {
  return (
    <div>
      <showCount info={INFO}  />
    </div>
  );
}
```

> ğŸ’¡ ì—…ë°ì´íŠ¸ê°€ ë˜ì§€ ì•ŠëŠ” ì¼ë°˜ì ì¸ ê°ì²´(ìƒìˆ˜ë‚˜ ê³ ìœ í•œ ê°’)ë¼ë©´ ë¦¬ì•¡íŠ¸ ì™¸ë¶€ë¡œ ë‚´ë³´ë‚´ê¸°


## 3. í”Œë˜ê·¸ ìƒíƒœ

**í”Œë˜ê·¸ ê°’** 

í”„ë¡œê·¸ë˜ë°ì—ì„œ ì£¼ë¡œ íŠ¹ì • ì¡°ê±´ í˜¹ì€ ì œì–´ë¥¼ ìœ„í•œ ì¡°ê±´ì„ booleanìœ¼ë¡œ ë‚˜íƒ€ë‚´ëŠ” ê°’

ex) ë¡œê·¸ì¸, ì¸ì¦/ì¸ê°€

- í”Œë˜ê·¸ ê°’ì„ ë§Œë“¤ë• êµ³ì´ ìƒíƒœë¥¼ ë§Œë“¤ì§€ ë§ê³  í‘œí˜„ì‹ìœ¼ë¡œ í•˜ë‚˜ì”© ë„£ìœ¼ë©´ useStateë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì˜ ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ë§Œë“¤ ìˆ˜ ìˆë‹¤.

```jsx
// âŒ
function FlagState() {
  const [isLogin, setIsLogin] = useState(false);
  useEffect(() => {
    if (hasToken) {
      setIsLogin(true);
    }
    if (hasCookie) {
      setIsLogin(true);
    }
    if (isValidCookie) {
      setIsLogin(true);
    }
    if (isValidToken) {
      setIsLogin(true);
    }
  }, [hasToken, hasCookie, isValidCookie, isValidToken]);
  return <div>{isLogin && 'ì•ˆë…•í•˜ì„¸ìš”! ë°˜ê°‘ìŠµë‹ˆë‹¤.'}</div>;
}
```
```jsx
// â­•ï¸
function FlagState() {
	const isLogin =
    hasToken &&
    hasCookie &&
    isValidCookie &&
    isValidToken;
  return <div>{isLogin && 'ì•ˆë…•í•˜ì„¸ìš”! ë°˜ê°‘ìŠµë‹ˆë‹¤.'}</div>;
}
```


> ğŸ’¡ useState ëŒ€ì‹  í”Œë˜ê·¸ë¡œ ìƒíƒœë¥¼ ì •ì˜í•  ìˆ˜ ìˆë‹¤.

## 4. ë¶ˆí•„ìš”í•œ ìƒíƒœ
* ì´ˆê¸°ê°’ì„ ë°”ê¿”ì•¼ í•˜ê±°ë‚˜ ë³€í•˜ëŠ” ê²½ìš°ì— ì‚¬ìš©ëœë‹¤.

```jsx
// âŒ
// 1. ì´ˆê¸° ìƒíƒœ ì„ ì–¸
const [userList, setUserList] = useState(MOCK_DATA);

// 2. ë³€ê²½ í›„ ì €ì¥í•  ë°ì´í„° ì„ ì–¸
const [complUserList, setComplUserList] = useState(MOCK_DATA);

useEffect(() => {
	const newList = complUserList.filter(
	  (user) => user.completed === true,
	);
  setUserList(newList);
}, [userList]);
```

```jsx
// â­•ï¸
// 1. ì´ˆê¸° ìƒíƒœ ì„ ì–¸
const [userList, setUserList] = useState(MOCK_DATA);

// 2. ë³€ê²½ í›„ ì €ì¥í•  ë°ì´í„° ì„ ì–¸ (ë‚´ë¶€ì˜ ë³€ìˆ˜ë¡œ ì‚¬ìš©)
const complUserList = complUserList.filter(
  (user) => user.completed === true,
);
```

* ë Œë”ë§ë  ë•Œë§ˆë‹¤ complUserListê°€ ìƒì„±ë˜ê¸° ë•Œë¬¸ì— ê´€ë¦¬í•  í•„ìš”ë„ ì—†ê³  setí•  í•„ìš”ë„ ì—†ë‹¤.  
* ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œì˜ ë³€ìˆ˜ëŠ”?
  * ë Œë”ë§ë§ˆë‹¤ ê³ ìœ ì˜ ê°’ì„ ê°€ì§€ëŠ” ê³„ì‚°ëœ ê°’

> ğŸ’¡  
> 1. propsë¥¼ useStateì— ë„£ì§€ ì•Šê³  ë°”ë¡œ return ë¬¸ì— ì‚¬ìš©í•˜ê¸°  
> 2. ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ ë³€ìˆ˜ëŠ” ë Œë”ë§ë§ˆë‹¤ ê³ ìœ í•œ ê°’ì„ ê°€ì§  
> 3. ë”°ë¼ì„œ useStateê°€ ì•„ë‹Œ constë¡œ ìƒíƒœë¥¼ ì„ ì–¸í•˜ëŠ”ê²Œ ì¢‹ì€ ê²½ìš°ë„ ìˆìŒ  

## 5. useState ëŒ€ì‹  useRef

```jsx
// âŒ
export const component = () => {
	const [isMount, setIsMount] = useState(false);

	useEffect(() => {
		if(!isMount) {
			setIsMount(true);
		}
	}, [isMount]);
};
```

```jsx
// â­•ï¸
export const component = () => {
	const isMount = useRef(false);

	useEffect(() => {
		isMount.current = true;

		return () => (isMount.current = false);
	}, []);
};
```

* ë¦¬ë Œë”ë§ ë°©ì§€ê°€ í•„ìš”í•˜ë‹¤ë©´ useState ëŒ€ì‹  useRef  
* ì»´í¬ë„ŒíŠ¸ì˜ ì „ì²´ì ì¸ ìˆ˜ëª…ê³¼ ë™ì¼í•˜ê²Œ ì§€ì†ëœ ì •ë³´ë¥¼ ì¼ê´€ì ìœ¼ë¡œ ì œê³µí•´ì•¼í•˜ëŠ” ê²½ìš°  

> ğŸ’¡ useState ëŒ€ì‹  useRefë¥¼ ì‚¬ìš©í•˜ë©´ ì»´í¬ë„ŒíŠ¸ì˜ ìƒëª…ì£¼ê¸°ì™€ ë™ì¼í•œ ë¦¬ë Œë”ë§ë˜ì§€ ì•ŠëŠ” ìƒíƒœë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤

## 6. ì—°ê´€ëœ ìƒíƒœ ë‹¨ìˆœí™”í•˜ê¸°

```jsx
// âŒ
import React from "react";

function FlatState() {
  const [isLoading, setIsLoading] = useState(false);
  const [isFinish, setIsFinish] = useState(false);
  const [isError, setIsError] = useState(false);

  const fetchData = async () => {
    // fetch Data ì‹œë„
    setIsLoading(true);

    fetch(url)
      .then(() => {
        // fetch Data ì„±ê³µ
        setIsLoading(false);
        setIsFinish(true);
      })
      .catch(() => {
        // fetch Data ì‹¤íŒ¨
        setIsError(true);
      });
  };
  if (isLoading) return <LoadingComponent />;
  if (isFinish) return <SuccessComponent />;
  if (isError) return <ErrorComponent />;

}

export default FlatState;
```

**ì ì¬ì  ë¬¸ì œ**

isLoading, isFinish, isError ëª¨ë‘ ì—°ê´€ì´ ìˆë‹¤. (ex. isLoadingì´ trueì¼ ê²½ìš°ëŠ” ë‚˜ë¨¸ì§€ ìƒíƒœëŠ” ëª¨ë‘ false)

**í•´ê²° ë°©ë²• : í•˜ë‚˜ë¡œ í•©ì¹˜ê¸°** 
- âœ…Â ì—´ê±°í˜• ë°ì´í„°ë¡œ ë°”ê¾¼ë‹¤. => 6. ì—°ê´€ëœ ìƒíƒœ ë‹¨ìˆœí™”í•˜ê¸°
- ê°ì²´ë¡œ í•©ì¹œë‹¤. => 7. ì—°ê´€ëœ ìƒíƒœ ê°ì²´ë¡œ ë¬¶ì–´ë‚´ê¸°
- ê°ì²´ë¡œ í•©ì³ì„œ reducerë¡œ ë¬¶ëŠ”ë‹¤. => 8. useStateì—ì„œ useReducerë¡œ ë¦¬íŒ©í„°ë§

```jsx
import React from "react";

const PROMISE_STATE = {
  INIT: "init",
  LOADING: "loading",
  FINISH: "finish",
  ERROR: "error",
}
function FlatState() {
  const [promiseState, setPromiseState] = useState(PROMISE_STATE.INIT)

  const fetchData = async () => {
    // fetch Data ì‹œë„
    setPromiseState(PROMISE_STATE.LOADING);

    fetch(url)
      .then(() => {
        // fetch Data ì„±ê³µ
        setPromiseState(PROMISE_STATE.FINISH);
      })
      .catch(() => {
        // fetch Data ì‹¤íŒ¨
        setPromiseState(PROMISE_STATE.ERROR);
      });
  };
  if (promiseState === PROMISE_STATE.LOADING) return <LoadingComponent />;
  if (promiseState === PROMISE_STATE.FINISH) return <SuccessComponent />;
  if (promiseState === PROMISE_STATE.ERROR) return <ErrorComponent />;
}

export default FlatState;
```

## 7. ì—°ê´€ëœ ìƒíƒœ ê°ì²´ë¡œ ë¬¶ì–´ë‚´ê¸°

í•˜ë‚˜ì˜ ìƒíƒœê°€ ë°”ë€” ë•Œ ë‚˜ë¨¸ì§€ ìƒíƒœë¥¼ ë™ê¸°í™”í•´ì¤˜ì•¼ í•œë‹¤.

```jsx
import React from "react";

function FlatState() {
  const [fetchState, setFetchState] = useState({
    isLoading: false,
    isFinish: false,
    isError: false,
  })
  const fetchData = async () => {
    // fetch Data ì‹œë„
    setFetchState({
      isLoading: true,
      isFinish: false,
      isError: false,
    });

    fetch(url)
      .then(() => {
        // fetch Data ì„±ê³µ
        setFetchState({
          isLoading: false,
          isFinish: true,
          isError: false,
        })
      })
      .catch(() => {
        // fetch Data ì‹¤íŒ¨
        setFetchState({
          isLoading: false,
          isFinish: false,
          isError: true,
        })
      });
  };
  if (fetchState.isLoading) return <LoadingComponent />;
  if (fetchState.isFinish) return <SuccessComponent />;
  if (fetchState.isError) return <ErrorComponent />;
}

export default FlatState;
```

ì´ì „ ìƒíƒœë¥¼ ì°¸ê³ í•˜ëŠ” prevStateë¥¼ spread operatorë¥¼ ì‚¬ìš©í•˜ì—¬ ë°˜ë³µë˜ëŠ” ì½”ë“œë¥¼ ì¤„ì—¬ì¤„ ìˆ˜ ìˆë‹¤.

```jsx
import React from "react";

function FlatState() {
  const [fetchState, setFetchState] = useState({
    isLoading: false,
    isFinish: false,
    isError: false,
  });
  const fetchData = async () => {
    // fetch Data ì‹œë„
    setFetchState((prevState) => ({
      ...prevState,
      isLoading: true,
    }));

    fetch(url)
      .then(() => {
        // fetch Data ì„±ê³µ
        setFetchState((prevState) => ({
          ...prevState,
          isFinish: true,
        }));
      })
      .catch(() => {
        // fetch Data ì‹¤íŒ¨
        setFetchState((prevState) => ({
          ...prevState,
          isError: true,
        }));
      });
  };
  if (fetchState.isLoading) return <LoadingComponent />;
  if (fetchState.isFinish) return <SuccessComponent />;
  if (fetchState.isError) return <ErrorComponent />;
}

export default FlatState;
```

í•˜ë‚˜ì˜ ìƒíƒœë§Œ useStateë¡œ ì‚¬ìš©í•  í•„ìš” ì—†ê³  ì—¬ëŸ¬ ìƒíƒœë„ useStateë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

## 8. useStateì—ì„œ useReducerë¡œ ë¦¬íŒ©í„°ë§

```jsx
import React from "react";

const INIT_STATE = {
  isLoading: false,
  isSuccess: false,
  isFail: false,
};

const reducer = (state, action) => {
  switch (action.type) {
    case "FETCH_LOADING":
      return { ...state, isLoading: true };
    case "FETCH_SUCCESS":
      return { ...state, isSuccess: true };
    case "FETCH_FAIL":
      return { ...state, isFail: true };
    default:
      return INIT_STATE;
  }
};
function StateToReducer() {
  const [state, dispatch] = useReducer(reducer, INIT_STATE);

  const fetchData = async () => {
    // fetch Data ì‹œë„
    dispatch({ type: "FETCH_LOADING" });

    fetch(url)
      .then(() => {
        // fetch Data ì„±ê³µ
        dispatch({ type: "FETCH_SUCCESS" });
      })
      .catch(() => {
        // fetch Data ì‹¤íŒ¨
        dispatch({ type: "FETCH_FAIL" });
      });
  };
  if (state.isLoading) return <LoadingComponent />;
  if (state.isSuccess) return <SuccessComponent />;
  if (state.isFail) return <FailComponent />;
}

export default StateToReducer;
```

action typeì„ í†µí•´ ë‚´ë¶€ë¡œì§ì„ ì¶”ìƒí™”í•´ì£¼ê¸° ë•Œë¬¸ì— typeë§Œ ë³´ê³ ë„ ì¶”ë¡ ì´ ê°€ëŠ¥í•˜ë‹¤.

ë” ë§ì€ ìƒíƒœê°€ ìˆì–´ë„ reducerì—ì„œ ê´€ë¦¬í•´ì¤„ ìˆ˜ ìˆë‹¤.

## 9. ìƒíƒœ ë¡œì§ Custom Hooksìœ¼ë¡œ ë½‘ì•„ë‚´ê¸°

```jsx
import React, { useEffect } from "react";

const INIT_STATE = {
  isLoading: false,
  isSuccess: false,
  isFail: false,
};

const reducer = (state, action) => {
  switch (action.type) {
    case "FETCH_LOADING":
      return { ...state, isLoading: true };
    case "FETCH_SUCCESS":
      return { ...state, isSuccess: true };
    case "FETCH_FAIL":
      return { ...state, isFail: true };
    default:
      return INIT_STATE;
  }
};
const useFetchData = (url) => {
  const [state, dispatch] = useReducer(reducer, INIT_STATE);

  useEffect(() => {
    const fetchData = async () => {
      // fetch Data ì‹œë„
      dispatch({ type: "FETCH_LOADING" });

      await fetch(url)
        .then(() => {
          // fetch Data ì„±ê³µ
          dispatch({ type: "FETCH_SUCCESS" });
        })
        .catch(() => {
          // fetch Data ì‹¤íŒ¨
          dispatch({ type: "FETCH_FAIL" });
        });
    };
    fetchData();
  }, [url]);

  return state;
};
function CustomHooks() {
  const { isLoading, isSuccess, isFail } = useFetchData("url");

  if (isLoading) return <LoadingComponent />;
  if (isSuccess) return <SuccessComponent />;
  if (isFail) return <FailComponent />;
}

export default StateToReducer;
```